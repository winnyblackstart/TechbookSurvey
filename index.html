<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digital Book Petition</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .project-description { background-color: #f0f8ff; padding: 20px; border-radius: 10px; margin-bottom: 20px; }
        .role-selector { text-align: center; margin-bottom: 30px; }
        .form-section { display: none; margin-top: 20px; }
        .question { margin: 15px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        button { padding: 10px 20px; background-color: #4CAF50; color: white; border: none; cursor: pointer; }
        button:hover { background-color: #45a049; }
        .thank-you { display: none; color: green; font-size: 1.2em; text-align: center; margin-top: 20px; }
        input[type="number"], input[type="text"] { padding: 5px; margin-left: 10px; width: 80%; }
    </style>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
</head>
<body>
    <div class="project-description">
        <h1>A Petition/ Une Pétition</h1>
        <p>En :<br><br>Please dear Parent and dear student help us by giving your opinion on This technological tool<br><br>Fr :<br><br>Cher parent et cher élève, aidez-nous en nous donnant votre opinion sur cet outil technologique.</p>
        <h2>Project Description / Description du projet</h2>
        <p>En :<br><br>This project is a numérique Note Book with which your children can go to school with it and copy their notes. One single device that can handle about 1000 Note books. And If you pay a subscription, the Note books of your children will be stored in the cloud and you can access your children's books from any device, thereby preventing losing notes.<br><br> Fr : <br><br>Ce projet est un Cahier numérique avec lequel vos enfants peuvent aller à l'école et copier leurs notes. Un seul appareil peut gérer environ 1000 Cahiers. Et si vous souscrivez un abonnement, les Cahiers de vos enfants seront stockés dans le cloud et vous pourrez accéder a leur Cahiers à partir de n'importe quel appareil, évitant ainsi la perte de notes.</p>
    </div>

    <div class="role-selector">
        <h2>Select Your Role</h2>
        <button onclick="showForm('parent')">Parent</button>
        <button onclick="showForm('student')">Student</button>
    </div>

    <!-- Parent Form -->
    <div id="parentForm" class="form-section">
        <h2>Parent Questions</h2>
        <form id="parentQuestions">
            <div class="question">
                <label for="parentName">Name:</label>
                <input type="text" id="parentName" name="parentName" required>
            </div>
            <div class="question">
                <p>En - 1) Will you buy the device?<br>Fr - 1) Allez-vous acheter l'appareil ?</p>
                <label><input type="radio" name="q1" value="yes" required> Yes/Oui</label>
                <label><input type="radio" name="q1" value="no"> No/Non</label>
            </div>
            <div class="question">
                <p>En - 2) Will you buy it if it cost 50,000 Frs?<br>Fr - 2) Allez-vous l'acheter si ça coûte 100 000 francs ?</p>
                <label><input type="radio" name="q2" value="yes" required> Yes/Oui</label>
                <label><input type="radio" name="q2" value="no"> No/Non</label>
            </div>
            <div class="question">
                <p>En - 3) Will you buy it if it cost 100,000 Frs?<br>Fr - 3) Allez-vous l'acheter si ça coûte 100 000 francs ?</p>
                <label><input type="radio" name="q3" value="yes" required> Yes/Oui</label>
                <label><input type="radio" name="q3" value="no"> No/Non</label>
            </div>
            <div class="question">
                <p>En - 4) Will you buy it if it cost 200,000 Frs?<br>Fr - 4) Allez-vous l'acheter si ça coûte 200 000 francs ?</p>
                <label><input type="radio" name="q4" value="yes" required> Yes/Oui</label>
                <label><input type="radio" name="q4" value="no"> No/Non</label>
            </div>
            <div class="question">
                <p>En - 5) Will you pay a subscription to save your children's notes?<br>Fr - 5) Allez-vous souscrire un abonnement pour sauvegarder les notes de vos enfants ?</p>
                <label><input type="radio" name="q5" value="yes" required> Yes/Oui</label>
                <label><input type="radio" name="q5" value="no"> No/Non</label>
            </div>
            <div class="question">
                <p>En - 6) How much could you pay for subscription?<br>Fr - 6) Combien seriez-vous prêt à payer pour un abonnement ?</p>
                <input type="number" name="q6" min="0" step="1000" required> Frs
            </div>
            <div class="question">
                <p>En - 7) If you were a teacher or a chair man in a school will you alow this technology in your school or class?<br>Fr - 7) Si vous étiez un enseignant ou un directeur d'école, autoriseriez-vous cette technologie dans votre école ou votre classe ?</p>
                <label><input type="radio" name="q7" value="yes" required> Yes/Oui</label>
                <label><input type="radio" name="q7" value="no"> No/Non</label>
            </div>
            <div class="question">
                <p>En - 8) Do you have any comments or suggestions?<br>Fr - 8) Avez-vous des commentaires ou des suggestions ?</p>
                <input type="text" name="q8" placeholder="Optional / Facultatif"> Frs
            </div>
            <button type="submit">Submit Answers</button>
        </form>
    </div>

    <!-- Student Form -->
    <div id="studentForm" class="form-section">
        <h2>Student Questions</h2>
        <form id="studentQuestions">
            <div class="question">
                <label for="studentName">Name:</label>
                <input type="text" id="studentName" name="studentName" required>
            </div>
            <div class="question">
                <p>En - 1) Will you like it if your parents buy it for you?<br>Fr - 1) Aimez-vous si vos parents l'achètent pour vous ?</p>
                <label><input type="radio" name="q1" value="yes" required> Yes/Oui</label>
                <label><input type="radio" name="q1" value="no"> No/Non</label>
            </div>
            <div class="question">
                <p>En - 2) Will you encourage your parents to buy it?<br>Fr - 2) Allez-vous encourager vos parents à l'acheter ?</p>
                <label><input type="radio" name="q2" value="yes" required> Yes/Oui</label>
                <label><input type="radio" name="q2" value="no"> No/Non</label>
            </div>
            <div class="question">
                <p>En - 3) Will you encourage your parents to pay subscription?<br>Fr - 3) Allez-vous encourager vos parents à souscrire un abonnement ?</p>
                <label><input type="radio" name="q3" value="yes" required> Yes/Oui</label>
                <label><input type="radio" name="q3" value="no"> No/Non</label>
            </div>
            <div class="question">
                <p>En - 4) Do you have any comments or suggestions?<br>Fr - 4) Avez-vous des commentaires ou des suggestions ?</p>
                <input type="text" name="q4" placeholder="Optional / Facultatif"> Frs
            </div>
            <button type="submit">Submit Answers</button>
        </form>
    </div>

    <div class="thank-you" id="thankYou">Thank you for your response!</div>

    <script>
    // Firebase Configuration
    const firebaseConfig = {
        apiKey: "AIzaSyCzGnav0quaepBDhsZBzwtNPcqH5ryv6RY",
        authDomain: "tbsurvey-cd371.firebaseapp.com",
        projectId: "tbsurvey-cd371",
        storageBucket: "tbsurvey-cd371.firebasestorage.app",
        messagingSenderId: "708969563479",
        appId: "1:708969563479:web:4874bf459f9fa6be9eaa12",
        measurementId: "G-C244TKTJLX"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    function showForm(role) {
        document.querySelectorAll('.form-section').forEach(form => {
            form.style.display = 'none';
        });
        document.getElementById(`${role}Form`).style.display = 'block';
    }

    // Common validation function
    function validateName(name) {
        const trimmed = name.trim();
        return trimmed.length >= 2 && trimmed.length <= 50;
    }

    // Enhanced submission handler
    async function handleSubmission(form, collectionName, dataShape) {
        const submitBtn = form.querySelector('button[type="submit"]');
        try {
            submitBtn.disabled = true;
            submitBtn.textContent = 'Submitting...';
            
            const formData = new FormData(form);
            const answers = dataShape(formData);
            
            // Additional client-side validation
            if (!validateName(answers.name)) {
                throw new Error('Please enter a valid name (2-50 characters)');
            }

            await db.collection(collectionName).add(answers);
            
            document.querySelectorAll('.form-section').forEach(f => f.style.display = 'none');
            document.getElementById('thankYou').style.display = 'block';
            setTimeout(() => location.reload(), 2000);
        } catch (error) {
            console.error("Submission error:", error);
            alert(`Submission failed: ${error.message}`);
            submitBtn.disabled = false;
            submitBtn.textContent = 'Submit Answers';
        }
    }

    // Parent form configuration
    document.getElementById('parentQuestions').addEventListener('submit', async (e) => {
        e.preventDefault();
        handleSubmission(e.target, 'parents', (formData) => ({
            name: formData.get('parentName').trim(),
            role: 'parent',
            q1: formData.get('q1'),
            q2: formData.get('q2'),
            q3: formData.get('q3'),
            q4: formData.get('q4'),
            q5: formData.get('q5'),
            q6: Number(formData.get('q6')),
            q7: formData.get('q7'),
            q8: formData.get('q8'),
            timestamp: firebase.firestore.FieldValue.serverTimestamp()
        }));
    });

    // Student form configuration
    document.getElementById('studentQuestions').addEventListener('submit', async (e) => {
        e.preventDefault();
        handleSubmission(e.target, 'children', (formData) => ({
            name: formData.get('studentName').trim(),
            role: 'student',
            q1: formData.get('q1'),
            q2: formData.get('q2'),
            q3: formData.get('q3'),
            q4: formData.get('q4'),
            timestamp: firebase.firestore.FieldValue.serverTimestamp()
        }));
    });
</script>
</body>
</html>
